<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Power Analysis for One-, Two-, Three-Way ANCOVA Contrasts and Multiple Comparisons (T-Tests) — power.t.contrasts • pwrss</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Power Analysis for One-, Two-, Three-Way ANCOVA Contrasts and Multiple Comparisons (T-Tests) — power.t.contrasts"><meta name="description" content="Calculates power or sample size for one-, two-, three-Way ANCOVA contrasts
and multiple comparisons. The power.t.contrasts() function permits
to test multiple contrasts (multiple comparisons) and also allows adjustment
to alpha due to multiple testing. Furthermore, power.t.contrasts()
accepts an object returned from the power.f.ancova.shieh() function
for convenience. Beware that, in this case, all other arguments are ignored
except alpha and adjust.alpha.
Formulas are validated using examples and tables in Shieh (2017)."><meta property="og:description" content="Calculates power or sample size for one-, two-, three-Way ANCOVA contrasts
and multiple comparisons. The power.t.contrasts() function permits
to test multiple contrasts (multiple comparisons) and also allows adjustment
to alpha due to multiple testing. Furthermore, power.t.contrasts()
accepts an object returned from the power.f.ancova.shieh() function
for convenience. Beware that, in this case, all other arguments are ignored
except alpha and adjust.alpha.
Formulas are validated using examples and tables in Shieh (2017)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pwrss</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/examples.html">Practical Power Analysis in R</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/metinbulus/pwrss/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Power Analysis for One-, Two-, Three-Way ANCOVA Contrasts and Multiple Comparisons (T-Tests)</h1>
      <small class="dont-index">Source: <a href="https://github.com/metinbulus/pwrss/blob/main/R/ancova.R" class="external-link"><code>R/ancova.R</code></a></small>
      <div class="d-none name"><code>power.t.contrasts.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates power or sample size for one-, two-, three-Way ANCOVA contrasts
and multiple comparisons. The <code>power.t.contrasts()</code> function permits
to test multiple contrasts (multiple comparisons) and also allows adjustment
to alpha due to multiple testing. Furthermore, <code>power.t.contrasts()</code>
accepts an object returned from the <code><a href="power.f.ancova.shieh.html">power.f.ancova.shieh()</a></code> function
for convenience. Beware that, in this case, all other arguments are ignored
except <code>alpha</code> and <code>adjust.alpha</code>.</p>
<p>Formulas are validated using examples and tables in Shieh (2017).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">power.t.contrasts</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mu.vector <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sd.vector <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n.vector <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  p.vector <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  r.squared <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  k.covariates <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  contrast.matrix <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  power <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  adjust.alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"tukey"</span>, <span class="st">"bonferroni"</span>, <span class="st">"holm"</span>, <span class="st">"hochberg"</span>, <span class="st">"hommel"</span>, <span class="st">"BH"</span>,</span>
<span>    <span class="st">"BY"</span>, <span class="st">"fdr"</span><span class="op">)</span>,</span>
<span>  ceiling <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  pretty <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>object; an object returned from the
<code><a href="power.f.ancova.shieh.html">power.f.ancova.shieh()</a></code> function.</p></dd>


<dt id="arg-mu-vector">mu.vector<a class="anchor" aria-label="anchor" href="#arg-mu-vector"></a></dt>
<dd><p>vector; adjusted means (or estimated marginal means)
for each level of a factor. Ignored when 'x' is
specified.</p></dd>


<dt id="arg-sd-vector">sd.vector<a class="anchor" aria-label="anchor" href="#arg-sd-vector"></a></dt>
<dd><p>vector; unadjusted standard deviations for each level
of a factor. Ignored when 'x' is specified.</p></dd>


<dt id="arg-n-vector">n.vector<a class="anchor" aria-label="anchor" href="#arg-n-vector"></a></dt>
<dd><p>vector; sample sizes for each level of a factor.
Ignored when 'x' is specified.</p></dd>


<dt id="arg-p-vector">p.vector<a class="anchor" aria-label="anchor" href="#arg-p-vector"></a></dt>
<dd><p>vector; proportion of total sample size in each level
of a factor. These proportions should sum to one.
Ignored when 'x' is specified.</p></dd>


<dt id="arg-r-squared">r.squared<a class="anchor" aria-label="anchor" href="#arg-r-squared"></a></dt>
<dd><p>explanatory power of covariates (R-squared) in the
ANCOVA model. Ignored when 'x' is specified.</p></dd>


<dt id="arg-k-covariates">k.covariates<a class="anchor" aria-label="anchor" href="#arg-k-covariates"></a></dt>
<dd><p>Number of covariates in the ANCOVA model. Ignored
when 'x' is specified.</p></dd>


<dt id="arg-contrast-matrix">contrast.matrix<a class="anchor" aria-label="anchor" href="#arg-contrast-matrix"></a></dt>
<dd><p>vector or matrix; contrasts should not be confused
with the model (design) matrix. Rows of contrast
matrix indicate independent vector of contrasts
summing to zero. The default contrast matrix is
constructed using deviation coding scheme (a.k.a.
effect coding). Columns in the contrast matrix
indicate number of levels or groups (or cells in
factorial designs). Ignored when 'x' is specified.</p></dd>


<dt id="arg-power">power<a class="anchor" aria-label="anchor" href="#arg-power"></a></dt>
<dd><p>statistical power, defined as the probability of
correctly rejecting a false null hypothesis, denoted
as \(1 - \beta\). Ignored when 'x' is specified.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>type 1 error rate, defined as the probability of
incorrectly rejecting a true null hypothesis, denoted
as \(\alpha\). Note that this should be specified
even if 'x' is specified. The 'alpha' value within
the 'x' object pertains to the omnibus test, NOT the
test of contrasts.</p></dd>


<dt id="arg-adjust-alpha">adjust.alpha<a class="anchor" aria-label="anchor" href="#arg-adjust-alpha"></a></dt>
<dd><p>character; one of the methods in c("none", "tukey",
"bonferroni", "holm", "hochberg", "hommel", "BH",
"BY", "fdr") to control Type 1 error. See
<code><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">?stats::p.adjust</a></code>.</p></dd>


<dt id="arg-ceiling">ceiling<a class="anchor" aria-label="anchor" href="#arg-ceiling"></a></dt>
<dd><p>logical; <code>TRUE</code> by default. If <code>FALSE</code>
sample sizes in each cell are NOT rounded up.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p><code>1</code> by default (returns test, hypotheses, and
results), if <code>2</code> a more detailed output is given
(plus key parameters and defintions), if <code>0</code> no
output is printed on the console.</p></dd>


<dt id="arg-pretty">pretty<a class="anchor" aria-label="anchor" href="#arg-pretty"></a></dt>
<dd><p>logical; whether the output should show Unicode
characters (if encoding allows for it). <code>FALSE</code>
by default.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>


<dl><dt>parms</dt>
<dd><p>list of parameters used in calculation.</p></dd>

<dt>test</dt>
<dd><p>type of the statistical test (T-Test).</p></dd>

<dt>contrast</dt>
<dd><p>contrast number (one contrast per line).</p></dd>

<dt>comparison</dt>
<dd><p>which factor levels are compared (one contrast per line).</p></dd>

<dt>psi</dt>
<dd><p>contrast-weighted mean difference (one contrast per line).</p></dd>

<dt>d</dt>
<dd><p>contrast-weighted standardized mean difference (one contrast per line).</p></dd>

<dt>ncp</dt>
<dd><p>non-centrality parameter for the alternative (one contrast per line).</p></dd>

<dt>df</dt>
<dd><p>degrees of freedom (one contrast per line).</p></dd>

<dt>t.alpha</dt>
<dd><p>critical values (one contrast per line).</p></dd>

<dt>n.total</dt>
<dd><p>total sample size (one contrast per line).</p></dd>

<dt>power</dt>
<dd><p>statistical power \((1-\beta)\) (one contrast per line).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Note that R has a partial matching feature which allows you to specify
shortened versions of arguments, such as <code>mu</code> or <code>mu.vec</code> instead
of <code>mu.vector</code>, or such as <code>k</code> or <code>k.cov</code> instead of
<code>k.covariates</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Shieh, G. (2017). Power and sample size calculations for contrast analysis
in ANCOVA. <em>Multivariate Behavioral Research, 52</em>(1), 1-11.
https://doi.org/10.1080/00273171.2016.1219841</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># see `?pwrss::power.f.ancova.shieh` for further examples</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># dummy coding example</span></span></span>
<span class="r-in"><span><span class="va">contrast.object</span> <span class="op">&lt;-</span> <span class="fu"><a href="factorial.contrasts.html">factorial.contrasts</a></span><span class="op">(</span>factor.levels <span class="op">=</span> <span class="fl">3</span>, coding <span class="op">=</span> <span class="st">"treatment"</span>, verbose <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">contrast.matrix</span> <span class="op">&lt;-</span> <span class="va">contrast.object</span><span class="op">[[</span><span class="st">"contrast.matrix"</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu">power.t.contrasts</span><span class="op">(</span>mu.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.15</span>, <span class="fl">0.30</span>, <span class="fl">0.20</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  sd.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,    <span class="fl">1</span>,    <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  p.vector  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>,  <span class="fl">1</span><span class="op">/</span><span class="fl">3</span>,  <span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  r.squared <span class="op">=</span> <span class="fl">0.50</span>, k.covariates <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                  contrast.matrix <span class="op">=</span> <span class="va">contrast.matrix</span>,</span></span>
<span class="r-in"><span>                  power <span class="op">=</span> <span class="fl">0.80</span>,</span></span>
<span class="r-in"><span>                  alpha <span class="op">=</span> <span class="fl">0.05</span>, adjust.alpha <span class="op">=</span> <span class="st">"holm"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +--------------------------------------------------+</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |             SAMPLE SIZE CALCULATION              |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +--------------------------------------------------+</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple Contrast Analyses (T-Tests)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hypotheses</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H0 (Null)        : psi  = 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H1 (Alternative) : psi != 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  contr comparison   psi      d    ncp n.total power</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1  A1 &lt;=&gt; A3 -0.05 -0.071 -3.084   11412   0.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      2  A2 &lt;=&gt; A3  0.10  0.141  3.085    2856   0.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Metin Bulus.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

